import{_ as M}from"./_plugin-vue_export-helper-DRcqrMy4.js";/* empty css                   *//* empty css                  *//* empty css               *//* empty css                     *//* empty css                  *//* empty css                 *//* empty css                 *//* empty css                   *//* empty css                  */import{r as p,o as T,b as i,d as r,C as V,g as n,w as u,a3 as Y,D as I,v as L,x as h,F as P,B as $,L as j,f as z,h as F,A as l,i as U,j as A,t as d,T as R,e as S,E as q,N as G,U as y}from"./index-COpeM2_A.js";import{f as J,h as K,i as O}from"./collection-MFINAby5.js";const Q={class:"history-page card"},W={class:"page-header"},X={class:"history-list"},Z=["onClick"],ee={class:"view-time"},te={key:1,class:"pagination-wrapper"},v=20,oe={__name:"History",setup(se){const k=z(),_=p(!1),s=p([]),c=p(0),m=p(1),g=async()=>{var t,e;_.value=!0;try{const a=await J({page:m.value,size:v});s.value=((t=a.data)==null?void 0:t.list)||[],c.value=((e=a.data)==null?void 0:e.total)||0}catch(a){console.error("获取浏览历史失败",a)}finally{_.value=!1}},C=async t=>{try{await O(t),y.success("删除成功"),s.value=s.value.filter(e=>e.hid!==t)}catch(e){console.error("删除失败",e)}},w=async()=>{try{await K(),y.success("已清空"),s.value=[],c.value=0}catch(t){console.error("清空失败",t)}},f=t=>t?R(t).format("YYYY-MM-DD HH:mm"):"-";return T(()=>{g()}),(t,e)=>{const a=U,D=Y,E=F("Delete"),x=q,H=G,b=j,B=I;return l(),i("div",Q,[r("div",W,[e[2]||(e[2]=r("h2",{class:"page-title"},"浏览历史",-1)),n(D,{title:"确定清空所有浏览历史吗？",onConfirm:w},{reference:u(()=>[n(a,{type:"danger",plain:"",disabled:!s.value.length},{default:u(()=>[...e[1]||(e[1]=[A("清空历史",-1)])]),_:1},8,["disabled"])]),_:1})]),V((l(),i("div",X,[(l(!0),i(P,null,$(s.value,o=>(l(),i("div",{class:"history-item",key:o.hid},[r("div",{class:"item-info",onClick:N=>S(k).push(`/works/${o.workId}`)},[r("h4",null,d(o.title),1),r("p",null,d(o.publisher)+" · "+d(f(o.publishTime)),1),r("span",ee,"浏览于 "+d(f(o.viewTime)),1)],8,Z),n(a,{text:"",type:"danger",onClick:N=>C(o.hid)},{default:u(()=>[n(x,null,{default:u(()=>[n(E)]),_:1})]),_:1},8,["onClick"])]))),128)),s.value.length?h("",!0):(l(),L(H,{key:0,description:"暂无浏览历史"})),c.value>v?(l(),i("div",te,[n(b,{"current-page":m.value,"onUpdate:currentPage":e[0]||(e[0]=o=>m.value=o),"page-size":v,total:c.value,layout:"prev, pager, next",background:"",onCurrentChange:g},null,8,["current-page","total"])])):h("",!0)])),[[B,_.value]])])}}},ge=M(oe,[["__scopeId","data-v-fac6504c"]]);export{ge as default};
