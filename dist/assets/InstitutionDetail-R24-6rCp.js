import{_ as K}from"./_plugin-vue_export-helper-DRcqrMy4.js";/* empty css                   *//* empty css                    *//* empty css                  *//* empty css               *//* empty css                     *//* empty css                  *//* empty css                 *//* empty css                 *//* empty css                        */import{r as u,J as R,o as X,C as A,D as q,b as c,x as f,d as o,v as d,w as r,t as h,g as n,j as D,E as G,K as H,a as Q,X as Y,h as b,A as a,M as Z,F as T,B as F,N as $,L as tt}from"./index-COpeM2_A.js";import{A as et}from"./AuthorCard-BVasQjuV.js";import{W as at}from"./WorkCard-BKm7B0rv.js";import{a as ot,b as st,c as nt}from"./institution-CYNKooG5.js";/* empty css                  */const lt={class:"institution-detail-page page-container"},rt={key:0,class:"institution-profile card"},it={class:"profile-header"},ut={class:"inst-logo"},ct={class:"profile-info"},dt=["href"],pt={class:"profile-stats"},_t={class:"stat-item"},vt={class:"stat-value"},mt={class:"stat-item"},gt={class:"stat-value"},ft={key:1,class:"institution-tabs card"},ht={class:"tab-content"},kt={key:0,class:"authors-grid"},yt={class:"tab-content"},bt={key:0,class:"works-grid"},_=12,wt={__name:"InstitutionDetail",setup(Ct){const w=Q(),C=u(!1),p=u(!1),i=u(null),E=u("authors"),k=u([]),I=u(1),v=u(0),y=u([]),x=u(1),m=u(0),W=async()=>{C.value=!0;try{const t=await ot(w.params.id);i.value=t.data}catch(t){console.error("获取机构信息失败",t)}finally{C.value=!1}},B=async()=>{var t,e;p.value=!0;try{const s=await st(w.params.id,{page:I.value,size:_});k.value=((t=s.data)==null?void 0:t.list)||[],v.value=((e=s.data)==null?void 0:e.total)||0}catch(s){console.error("获取学者失败",s)}finally{p.value=!1}},U=async()=>{var t,e;p.value=!0;try{const s=await nt(w.params.id,{page:x.value,size:_});y.value=((t=s.data)==null?void 0:t.list)||[],m.value=((e=s.data)==null?void 0:e.total)||0}catch(s){console.error("获取著作失败",s)}finally{p.value=!1}},V=t=>t?t>=1e4?(t/1e4).toFixed(1)+"w":t>=1e3?(t/1e3).toFixed(1)+"k":t:0;return R(E,t=>{t==="authors"&&!k.value.length&&v.value>0&&B(),t==="works"&&!y.value.length&&m.value>0&&U()}),X(()=>{W(),B(),U()}),(t,e)=>{const s=b("OfficeBuilding"),g=G,j=Y,M=b("Link"),O=b("User"),L=$,N=tt,P=Z,S=b("Document"),J=H,z=q;return A((a(),c("div",lt,[i.value?(a(),c("div",rt,[o("div",it,[o("div",ut,[i.value.imgUrl?(a(),d(j,{key:0,src:i.value.imgUrl,fit:"contain"},{error:r(()=>[n(g,{size:60,color:"#4A90E2"},{default:r(()=>[n(s)]),_:1})]),_:1},8,["src"])):(a(),d(g,{key:1,size:60,color:"#4A90E2"},{default:r(()=>[n(s)]),_:1}))]),o("div",ct,[o("h1",null,h(i.value.name),1),i.value.homepageUrl?(a(),c("a",{key:0,href:i.value.homepageUrl,target:"_blank",class:"homepage-link"},[n(g,null,{default:r(()=>[n(M)]),_:1}),e[3]||(e[3]=D(" 访问官网 ",-1))],8,dt)):f("",!0)])]),o("div",pt,[o("div",_t,[o("span",vt,h(V(i.value.worksCount)),1),e[4]||(e[4]=o("span",{class:"stat-label"},"著作数量",-1))]),o("div",mt,[o("span",gt,h(V(i.value.citedByCount)),1),e[5]||(e[5]=o("span",{class:"stat-label"},"总引用数",-1))])])])):f("",!0),i.value?(a(),c("div",ft,[n(J,{modelValue:E.value,"onUpdate:modelValue":e[2]||(e[2]=l=>E.value=l)},{default:r(()=>[n(P,{label:"学者",name:"authors"},{label:r(()=>[o("span",null,[n(g,null,{default:r(()=>[n(O)]),_:1}),D(" 学者 ("+h(v.value)+")",1)])]),default:r(()=>[A((a(),c("div",ht,[k.value.length?(a(),c("div",kt,[(a(!0),c(T,null,F(k.value,l=>(a(),d(et,{key:l.id,author:l},null,8,["author"]))),128))])):(a(),d(L,{key:1,description:"暂无学者"})),v.value>_?(a(),d(N,{key:2,"current-page":I.value,"onUpdate:currentPage":e[0]||(e[0]=l=>I.value=l),"page-size":_,total:v.value,layout:"total, prev, pager, next, jumper",background:"",class:"pagination",onCurrentChange:B},null,8,["current-page","total"])):f("",!0)])),[[z,p.value]])]),_:1}),n(P,{label:"著作",name:"works"},{label:r(()=>[o("span",null,[n(g,null,{default:r(()=>[n(S)]),_:1}),D(" 著作 ("+h(m.value)+")",1)])]),default:r(()=>[A((a(),c("div",yt,[y.value.length?(a(),c("div",bt,[(a(!0),c(T,null,F(y.value,l=>(a(),d(at,{key:l.workId,work:l},null,8,["work"]))),128))])):(a(),d(L,{key:1,description:"暂无著作"})),m.value>_?(a(),d(N,{key:2,"current-page":x.value,"onUpdate:currentPage":e[1]||(e[1]=l=>x.value=l),"page-size":_,total:m.value,layout:"total, prev, pager, next, jumper",background:"",class:"pagination",onCurrentChange:U},null,8,["current-page","total"])):f("",!0)])),[[z,p.value]])]),_:1})]),_:1},8,["modelValue"])])):f("",!0)])),[[z,C.value]])}}},jt=K(wt,[["__scopeId","data-v-b7ba2dfe"]]);export{jt as default};
