import{_ as O}from"./_plugin-vue_export-helper-DRcqrMy4.js";/* empty css                   *//* empty css                   *//* empty css                     *//* empty css                 *//* empty css                    *//* empty css                 *//* empty css               *//* empty css                  */import{g as $,c as G,a as J}from"./application-CxleYuOl.js";import{r as u,O as K,J as R,o as q,b as p,d as n,g as l,w as o,K as Q,a1 as W,h as X,A as i,M as Z,C as T,i as ee,j as m,E as te,v as A,x as M,F as U,B,t as r,T as ae,G as le,N as oe,D as se,P as ne,R as ie,l as re,U as F}from"./index-COpeM2_A.js";const ue={class:"applications-page card"},pe={class:"applications-list"},de={class:"app-info"},me={class:"app-time"},ce={class:"claims-list"},fe={class:"app-info"},_e={class:"app-time"},ve={__name:"Applications",setup(ge){const v=u("applications"),g=u(!1),y=u(!1),V=u(!1),b=u([]),c=u([]),d=u(!1),s=K({authorId:"",authorName:"",institutionName:"",field:""}),E=async()=>{var a;g.value=!0;try{const e=await $({page:1,size:50});b.value=((a=e.data)==null?void 0:a.list)||[]}catch(e){console.error("获取申请记录失败",e)}finally{g.value=!1}},P=async()=>{var a;y.value=!0;try{const e=await J({page:1,size:50});c.value=((a=e.data)==null?void 0:a.list)||[]}catch(e){console.error("获取认领记录失败",e)}finally{y.value=!1}},Y=async()=>{if(!s.authorId||!s.authorName){F.warning("请填写必要信息");return}V.value=!0;try{await G(s),F.success("申请提交成功"),d.value=!1,Object.keys(s).forEach(a=>s[a]=""),E()}catch(a){console.error("提交失败",a)}finally{V.value=!1}},N=a=>a===0?"warning":a===1?"success":"danger",w=a=>a===0?"待处理":a===1?"已通过":"已拒绝",I=a=>a?ae(a).format("YYYY-MM-DD HH:mm"):"-";return R(v,a=>{a==="claims"&&!c.value.length&&P()}),q(()=>{E()}),(a,e)=>{const j=X("Plus"),z=te,h=ee,k=le,D=oe,x=Z,L=Q,f=re,_=ie,S=ne,H=W,C=se;return i(),p("div",ue,[e[11]||(e[11]=n("h2",{class:"page-title"},"我的申请",-1)),l(L,{modelValue:v.value,"onUpdate:modelValue":e[1]||(e[1]=t=>v.value=t)},{default:o(()=>[l(x,{label:"学者申请",name:"applications"},{default:o(()=>[l(h,{type:"primary",size:"small",onClick:e[0]||(e[0]=t=>d.value=!0),style:{"margin-bottom":"16px"}},{default:o(()=>[l(z,null,{default:o(()=>[l(j)]),_:1}),e[8]||(e[8]=m("发起申请 ",-1))]),_:1}),T((i(),p("div",pe,[(i(!0),p(U,null,B(b.value,t=>(i(),p("div",{class:"app-item",key:t.applicationId},[n("div",de,[n("h4",null,"申请绑定学者："+r(t.authorName),1),n("p",null,"机构："+r(t.institutionName)+" · 领域："+r(t.field),1),n("span",me,"申请时间："+r(I(t.applicationTime)),1)]),l(k,{type:N(t.status)},{default:o(()=>[m(r(w(t.status)),1)]),_:2},1032,["type"])]))),128)),b.value.length?M("",!0):(i(),A(D,{key:0,description:"暂无申请记录"}))])),[[C,g.value]])]),_:1}),l(x,{label:"成果认领",name:"claims"},{default:o(()=>[T((i(),p("div",ce,[(i(!0),p(U,null,B(c.value,t=>(i(),p("div",{class:"app-item",key:t.cid},[n("div",fe,[n("h4",null,"认领著作ID："+r(t.workId),1),n("p",null,"理由："+r(t.reason),1),n("span",_e,"申请时间："+r(I(t.time)),1)]),l(k,{type:N(t.status)},{default:o(()=>[m(r(w(t.status)),1)]),_:2},1032,["type"])]))),128)),c.value.length?M("",!0):(i(),A(D,{key:0,description:"暂无认领记录"}))])),[[C,y.value]])]),_:1})]),_:1},8,["modelValue"]),l(H,{modelValue:d.value,"onUpdate:modelValue":e[7]||(e[7]=t=>d.value=t),title:"申请成为学者",width:"500px"},{footer:o(()=>[l(h,{onClick:e[6]||(e[6]=t=>d.value=!1)},{default:o(()=>[...e[9]||(e[9]=[m("取消",-1)])]),_:1}),l(h,{type:"primary",onClick:Y,loading:V.value},{default:o(()=>[...e[10]||(e[10]=[m("提交",-1)])]),_:1},8,["loading"])]),default:o(()=>[l(S,{model:s,"label-width":"100px"},{default:o(()=>[l(_,{label:"学者ID"},{default:o(()=>[l(f,{modelValue:s.authorId,"onUpdate:modelValue":e[2]||(e[2]=t=>s.authorId=t),placeholder:"请输入要绑定的学者ID"},null,8,["modelValue"])]),_:1}),l(_,{label:"学者姓名"},{default:o(()=>[l(f,{modelValue:s.authorName,"onUpdate:modelValue":e[3]||(e[3]=t=>s.authorName=t),placeholder:"请输入学者姓名"},null,8,["modelValue"])]),_:1}),l(_,{label:"机构名称"},{default:o(()=>[l(f,{modelValue:s.institutionName,"onUpdate:modelValue":e[4]||(e[4]=t=>s.institutionName=t),placeholder:"请输入所在机构"},null,8,["modelValue"])]),_:1}),l(_,{label:"研究领域"},{default:o(()=>[l(f,{modelValue:s.field,"onUpdate:modelValue":e[5]||(e[5]=t=>s.field=t),placeholder:"请输入研究领域"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},Ce=O(ve,[["__scopeId","data-v-0ac02886"]]);export{Ce as default};
