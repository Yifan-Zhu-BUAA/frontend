import{_ as w}from"./_plugin-vue_export-helper-DRcqrMy4.js";/* empty css                   *//* empty css                  *//* empty css               *//* empty css                     *//* empty css                  *//* empty css                 *//* empty css                 */import{a as D,m as z}from"./message-C7Wo8Iap.js";import{r as l,o as N,b as r,d as n,C as V,D as Y,v as f,x as _,F as b,B as L,g as u,L as T,h as j,A as s,a2 as F,w as y,E as H,t as m,T as I,j as P,G as R,N as A}from"./index-COpeM2_A.js";const G={class:"messages-page card"},S={class:"messages-list"},U=["onClick"],$={class:"msg-icon"},q={class:"msg-content"},J={class:"msg-time"},K={key:1,class:"pagination-wrapper"},g=20,O={__name:"Messages",setup(Q){const i=l(!1),c=l([]),d=l(0),p=l(1),v=async()=>{var t,e;i.value=!0;try{const o=await D({page:p.value,size:g});c.value=((t=o.data)==null?void 0:t.list)||[],d.value=((e=o.data)==null?void 0:e.total)||0}catch(o){console.error("获取消息失败",o)}finally{i.value=!1}},h=async t=>{if(!t.read)try{await z(t.id),t.read=!0}catch(e){console.error("标记已读失败",e)}},k=t=>t?I(t).format("YYYY-MM-DD HH:mm"):"-";return N(()=>{v()}),(t,e)=>{const o=j("Bell"),C=H,M=R,x=A,B=T,E=Y;return s(),r("div",G,[e[2]||(e[2]=n("h2",{class:"page-title"},"我的消息",-1)),V((s(),r("div",S,[(s(!0),r(b,null,L(c.value,a=>(s(),r("div",{class:F(["message-item",{unread:!a.read}]),key:a.id,onClick:W=>h(a)},[n("div",$,[u(C,{size:24},{default:y(()=>[u(o)]),_:1})]),n("div",q,[n("h4",null,m(a.title),1),n("p",null,m(a.content),1),n("span",J,m(k(a.time)),1)]),a.read?_("",!0):(s(),f(M,{key:0,type:"danger",size:"small"},{default:y(()=>[...e[1]||(e[1]=[P("未读",-1)])]),_:1}))],10,U))),128)),c.value.length?_("",!0):(s(),f(x,{key:0,description:"暂无消息"})),d.value>g?(s(),r("div",K,[u(B,{"current-page":p.value,"onUpdate:currentPage":e[0]||(e[0]=a=>p.value=a),"page-size":g,total:d.value,layout:"prev, pager, next",background:"",onCurrentChange:v},null,8,["current-page","total"])])):_("",!0)])),[[E,i.value]])])}}},ie=w(O,[["__scopeId","data-v-fde71b38"]]);export{ie as default};
