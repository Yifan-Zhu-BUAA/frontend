import{_ as Q}from"./_plugin-vue_export-helper-DRcqrMy4.js";/* empty css                   *//* empty css                  *//* empty css               *//* empty css                     *//* empty css                  *//* empty css                 *//* empty css                 *//* empty css                    */import{c as M,a as X,r as l,J as Y,o as Z,b as s,d as i,C as $,x as C,j as T,t as z,g as o,w as c,K as ee,D as te,F as v,v as _,B as N,L as ae,f as se,h as S,A as e,M as oe,E as le,N as ne}from"./index-COpeM2_A.js";import{A as re}from"./AuthorCard-BVasQjuV.js";import{W as ue}from"./WorkCard-BKm7B0rv.js";import{I as ie}from"./InstitutionCard-BRu9531G.js";import{C as ce}from"./ConceptCard-2PYDWdmQ.js";import{g as O}from"./author-CZ4S9Kiu.js";import{g as J}from"./work-CbuoV90x.js";import{g as K}from"./institution-CYNKooG5.js";import{g as G}from"./concept-BRVEIubn.js";/* empty css                  *//* empty css                        */const de={class:"search-page page-container"},pe={class:"search-header"},ve={class:"search-info"},_e={class:"keyword"},me={key:0},ge={class:"search-tabs"},ke={class:"search-results"},he={key:0,class:"results-grid results-grid-4"},ye={key:0,class:"results-grid results-grid-3"},we={key:0,class:"results-grid results-grid-3"},fe={key:0,class:"results-grid results-grid-3"},be={key:0,class:"pagination-wrapper"},Ce={__name:"Search",setup(ze){const q=X();se();const n=M(()=>q.query.keyword||""),d=l("authors"),p=l(1),k=l(12),U=l(!1),P=l([]),L=l([]),W=l([]),j=l([]),E=l(0),x=l(0),B=l(0),V=l(0),D=M(()=>{switch(d.value){case"authors":return E.value;case"works":return x.value;case"institutions":return B.value;case"concepts":return V.value;default:return 0}}),H=()=>{p.value=1,R()},R=async()=>{var h,a,m,u,r,y,w,f;if(n.value){U.value=!0;try{switch(d.value){case"authors":const b=await O({keyword:n.value,page:p.value,size:k.value});P.value=((h=b.data)==null?void 0:h.list)||[],E.value=((a=b.data)==null?void 0:a.total)||0;break;case"works":const g=await J({keyword:n.value,page:p.value,size:k.value});L.value=((m=g.data)==null?void 0:m.list)||[],x.value=((u=g.data)==null?void 0:u.total)||0;break;case"institutions":const I=await K({keyword:n.value,page:p.value,size:k.value});W.value=((r=I.data)==null?void 0:r.list)||[],B.value=((y=I.data)==null?void 0:y.total)||0;break;case"concepts":const A=await G({keyword:n.value,page:p.value,size:k.value});j.value=((w=A.data)==null?void 0:w.list)||[],V.value=((f=A.data)==null?void 0:f.total)||0;break}}catch(b){console.error("搜索失败",b)}finally{U.value=!1}}},F=async()=>{var h,a,m,u;if(n.value)try{const[r,y,w,f]=await Promise.all([O({keyword:n.value,page:1,size:1}),J({keyword:n.value,page:1,size:1}),K({keyword:n.value,page:1,size:1}),G({keyword:n.value,page:1,size:1})]);E.value=((h=r.data)==null?void 0:h.total)||0,x.value=((a=y.data)==null?void 0:a.total)||0,B.value=((m=w.data)==null?void 0:m.total)||0,V.value=((u=f.data)==null?void 0:u.total)||0}catch(r){console.error("获取统计失败",r)}};return Y(()=>q.query.keyword,()=>{p.value=1,R(),F()}),Z(()=>{R(),F()}),(h,a)=>{const m=S("User"),u=le,r=oe,y=S("Document"),w=S("OfficeBuilding"),f=S("Connection"),b=ee,g=ne,I=ae,A=te;return e(),s("div",de,[i("div",pe,[a[4]||(a[4]=i("h1",null,"搜索结果",-1)),i("p",ve,[a[3]||(a[3]=T(" 关键词: ",-1)),i("span",_e,z(n.value),1),D.value?(e(),s("span",me," · 共找到 "+z(D.value)+" 条结果",1)):C("",!0)])]),i("div",ge,[o(b,{modelValue:d.value,"onUpdate:modelValue":a[0]||(a[0]=t=>d.value=t),onTabChange:H},{default:c(()=>[o(r,{label:"学者",name:"authors"},{label:c(()=>[i("span",null,[o(u,null,{default:c(()=>[o(m)]),_:1}),T(" 学者 ("+z(E.value)+")",1)])]),_:1}),o(r,{label:"著作",name:"works"},{label:c(()=>[i("span",null,[o(u,null,{default:c(()=>[o(y)]),_:1}),T(" 著作 ("+z(x.value)+")",1)])]),_:1}),o(r,{label:"机构",name:"institutions"},{label:c(()=>[i("span",null,[o(u,null,{default:c(()=>[o(w)]),_:1}),T(" 机构 ("+z(B.value)+")",1)])]),_:1}),o(r,{label:"概念",name:"concepts"},{label:c(()=>[i("span",null,[o(u,null,{default:c(()=>[o(f)]),_:1}),T(" 概念 ("+z(V.value)+")",1)])]),_:1})]),_:1},8,["modelValue"])]),$((e(),s("div",ke,[d.value==="authors"?(e(),s(v,{key:0},[P.value.length?(e(),s("div",he,[(e(!0),s(v,null,N(P.value,t=>(e(),_(re,{key:t.id,author:t},null,8,["author"]))),128))])):(e(),_(g,{key:1,description:"没有找到相关学者"}))],64)):C("",!0),d.value==="works"?(e(),s(v,{key:1},[L.value.length?(e(),s("div",ye,[(e(!0),s(v,null,N(L.value,t=>(e(),_(ue,{key:t.workId,work:t},null,8,["work"]))),128))])):(e(),_(g,{key:1,description:"没有找到相关著作"}))],64)):C("",!0),d.value==="institutions"?(e(),s(v,{key:2},[W.value.length?(e(),s("div",we,[(e(!0),s(v,null,N(W.value,t=>(e(),_(ie,{key:t.id,institution:t},null,8,["institution"]))),128))])):(e(),_(g,{key:1,description:"没有找到相关机构"}))],64)):C("",!0),d.value==="concepts"?(e(),s(v,{key:3},[j.value.length?(e(),s("div",fe,[(e(!0),s(v,null,N(j.value,t=>(e(),_(ce,{key:t.id,concept:t},null,8,["concept"]))),128))])):(e(),_(g,{key:1,description:"没有找到相关概念"}))],64)):C("",!0)])),[[A,U.value]]),D.value>0?(e(),s("div",be,[o(I,{"current-page":p.value,"onUpdate:currentPage":a[1]||(a[1]=t=>p.value=t),"page-size":k.value,"onUpdate:pageSize":a[2]||(a[2]=t=>k.value=t),total:D.value,"page-sizes":[10,20,50],layout:"total, sizes, prev, pager, next, jumper",background:"",onSizeChange:R,onCurrentChange:R},null,8,["current-page","page-size","total"])])):C("",!0)])}}},Je=Q(Ce,[["__scopeId","data-v-c1827b2d"]]);export{Je as default};
